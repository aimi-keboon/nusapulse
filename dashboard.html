<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NusaPulse - Metabolic Age Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #333;
        }

        .navbar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4facfe;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
        }

        .nav-menu a {
            text-decoration: none;
            color: #666;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            color: #4facfe;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 5px;
        }

        .mobile-menu {
            display: none;
            position: absolute;
            top: 70px;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
        }

        .mobile-menu.active {
            display: block;
        }

        .mobile-menu a {
            display: block;
            padding: 15px 0;
            text-decoration: none;
            color: #666;
            font-weight: 500;
            border-bottom: 1px solid #f1f5f9;
            transition: color 0.3s ease;
        }

        .mobile-menu a:last-child {
            border-bottom: none;
        }

        .mobile-menu a:hover,
        .mobile-menu a.active {
            color: #4facfe;
        }

        .mobile-user-info {
            display: none;
            padding: 15px 0;
            border-bottom: 1px solid #f1f5f9;
            margin-bottom: 10px;
        }

        .mobile-logout {
            display: none;
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            width: 100%;
            margin-top: 15px;
            transition: background 0.3s ease;
        }

        .mobile-logout:hover {
            background: #ff5252;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            font-weight: 500;
            color: #333;
        }

        .logout-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .logout-btn:hover {
            background: #ff5252;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .welcome-section {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .welcome-title {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .metabolic-age-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .age-comparison {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .age-item {
            text-align: center;
        }

        .age-label {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 5px;
        }

        .age-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .chronological-age {
            color: #64748b;
        }

        .metabolic-age {
            color: #ef4444;
        }

        .age-better {
            color: #22c55e;
        }

        .age-difference {
            background: #ef4444;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .age-difference.better {
            background: #22c55e;
        }

        .horizontal-meter {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 80px;
            margin: 20px auto;
            background: #f1f5f9;
            border-radius: 40px;
            padding: 8px;
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.1);
        }

        .age-track {
            position: relative;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, 
                #22c55e 0%, #22c55e 25%,
                #84cc16 25%, #84cc16 45%,
                #f59e0b 45%, #f59e0b 65%,
                #ef4444 65%, #ef4444 85%,
                #dc2626 85%, #dc2626 100%);
            border-radius: 32px;
            overflow: hidden;
        }

        .age-slider {
            position: absolute;
            top: 50%;
            left: 150px;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            cursor: grab;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            user-select: none;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border: 3px solid #e5e7eb;
            z-index: 10;
        }

        .age-slider:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            transform: translate(-50%, -50%) scale(1.05);
        }

        .slider-icon {
            width: 28px;
            height: 28px;
            margin-bottom: 2px;
        }

        .slider-age {
            font-size: 0.75rem;
            font-weight: bold;
            color: #374151;
        }

        .age-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 0 35px;
        }

        .label-item {
            text-align: center;
            font-size: 0.8rem;
            color: #64748b;
        }

        .label-age {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .improvement-message {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
            text-align: left;
            border-left: 4px solid #3b82f6;
        }

        .message-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .message-content {
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .metrics-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .metric-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }

        .metric-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .metric-item.critical { border-left-color: #ef4444; }
        .metric-item.high { border-left-color: #f59e0b; }
        .metric-item.medium { border-left-color: #3b82f6; }

        .metric-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .metric-text {
            flex: 1;
        }

        .metric-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }

        .metric-desc {
            font-size: 0.8rem;
            color: #64748b;
            line-height: 1.3;
        }

        .metric-impact {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
            color: white;
            white-space: nowrap;
        }

        .metric-impact.critical { background: #ef4444; }
        .metric-impact.high { background: #f59e0b; }
        .metric-impact.medium { background: #3b82f6; }

        .quick-actions {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .quick-actions h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .action-btn {
            background: #f1f5f9;
            border: 2px solid transparent;
            padding: 20px;
            border-radius: 12px;
            text-decoration: none;
            color: #333;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .action-btn:hover {
            border-color: #4facfe;
            background: #eff6ff;
            transform: translateY(-2px);
        }

        .action-btn-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .metabolic-factors {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            grid-column: 1 / -1;
        }

        .factors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .factor-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border-left: 4px solid;
        }

        .factor-item.excellent { border-left-color: #22c55e; }
        .factor-item.good { border-left-color: #84cc16; }
        .factor-item.fair { border-left-color: #f59e0b; }
        .factor-item.poor { border-left-color: #ef4444; }
        .factor-item.unknown { border-left-color: #94a3b8; }

        .factor-name {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 8px;
        }

        .factor-value {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .factor-impact {
            font-size: 0.8rem;
            color: #64748b;
            margin-bottom: 5px;
        }

        .factor-status {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .treatment-recommendations {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .treatment-intro {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 4px solid #4facfe;
        }

        .treatment-intro p {
            color: #0c4a6e;
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
        }

        .treatment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .treatment-card {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
        }

        .treatment-card:hover {
            border-color: #4facfe;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.15);
        }

        .treatment-card.priority {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        }

        .treatment-card.priority:hover {
            border-color: #dc2626;
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.15);
        }

        .treatment-card.featured {
            border-color: #22c55e;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }

        .treatment-card.featured:hover {
            border-color: #16a34a;
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.15);
        }

        .treatment-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .treatment-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .treatment-badge {
            background: #ef4444;
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .treatment-badge.featured {
            background: #22c55e;
        }

        .treatment-card h4 {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 12px;
        }

        .treatment-card p {
            color: #64748b;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .treatment-benefits {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .benefit-tag {
            background: #4facfe;
            color: white;
            font-size: 0.8rem;
            font-weight: 500;
            padding: 4px 10px;
            border-radius: 15px;
        }

        .treatment-card.priority .benefit-tag {
            background: #ef4444;
        }

        .treatment-card.featured .benefit-tag {
            background: #22c55e;
        }

        .treatment-duration {
            color: #64748b;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 20px;
            font-style: italic;
        }

        .treatment-btn {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #4facfe;
            color: white;
        }

        .treatment-btn:hover {
            background: #3b95fe;
            transform: translateY(-2px);
        }

        .treatment-btn.primary {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .treatment-btn.primary:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }

        .treatment-btn.featured {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        }

        .treatment-btn.featured:hover {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
        }

        .treatment-cta {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: white;
        }

        .cta-content h4 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .cta-content p {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .cta-btn {
            background: white;
            color: #4facfe;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .user-menu {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .mobile-user-info {
                display: block;
            }
            
            .mobile-logout {
                display: block;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .factors-grid {
                grid-template-columns: 1fr;
            }

            .treatment-grid {
                grid-template-columns: 1fr;
            }

            .treatment-card {
                padding: 20px;
            }

            .treatment-benefits {
                flex-direction: column;
                gap: 5px;
            }

            .benefit-tag {
                width: fit-content;
            }

            .horizontal-meter {
                max-width: 300px;
                height: 70px;
            }

            .age-slider {
                width: 60px;
                height: 60px;
            }

            .slider-icon {
                width: 24px;
                height: 24px;
            }

            .slider-age {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">🏥 NusaPulse</div>
            
            <!-- Desktop Menu -->
            <div class="nav-menu">
                <a href="dashboard.html" class="active">Dashboard</a>
                <a href="upload.html">Upload Files</a>
                <a href="history.html">Health History</a>
                <a href="profile.html">Profile</a>
            </div>
            
            <!-- Desktop User Menu -->
            <div class="user-menu">
                <span class="user-info" id="userName">Loading...</span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            
            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <span id="menuIcon">☰</span>
            </button>
        </div>
        
        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-user-info">
                <strong id="mobileUserName">Loading...</strong>
            </div>
            <a href="dashboard.html" class="active">Dashboard</a>
            <a href="upload.html">Upload Files</a>
            <a href="history.html">Health History</a>
            <a href="profile.html">Profile</a>
            <button class="mobile-logout" onclick="logout()">Logout</button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Welcome Section -->
        <div class="welcome-section">
            <h1 class="welcome-title">Welcome back, <span id="welcomeName">User</span>!</h1>
            <p class="welcome-subtitle">Discover how to reverse your metabolic age and optimize your health</p>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Metabolic Age Slider -->
            <div class="metabolic-age-card">
                <h3 style="margin-bottom: 15px;">🧬 Metabolic Age Explorer</h3>
                
                <div class="age-comparison">
                    <div class="age-item">
                        <div class="age-label">Your Age</div>
                        <div class="age-value chronological-age" id="chronologicalAge">33</div>
                        <div style="font-size: 0.8rem; color: #64748b;">Chronological</div>
                    </div>
                    <div class="age-difference" id="ageDifference">+9 years</div>
                    <div class="age-item">
                        <div class="age-label">Metabolic Age</div>
                        <div class="age-value metabolic-age" id="metabolicAge">42</div>
                        <div style="font-size: 0.8rem; color: #64748b;">Based on health data</div>
                    </div>
                </div>

                <p style="color: #666; margin-bottom: 20px; font-size: 0.9rem; text-align: center;">
                    Drag the slider to see what improvements can reduce your metabolic age
                </p>
                
                <div class="horizontal-meter">
                    <div class="age-track">
                        <div class="age-slider" id="ageSlider">
                            <svg class="slider-icon" id="ageIcon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="#ef4444"/>
                            </svg>
                            <div class="slider-age" id="sliderAge">42</div>
                        </div>
                    </div>
                    <div class="age-labels">
                        <div class="label-item">
                            <div class="label-age">20</div>
                            <div>Optimal</div>
                        </div>
                        <div class="label-item">
                            <div class="label-age">30</div>
                            <div>Good</div>
                        </div>
                        <div class="label-item">
                            <div class="label-age">40</div>
                            <div>Fair</div>
                        </div>
                        <div class="label-item">
                            <div class="label-age">50</div>
                            <div>Poor</div>
                        </div>
                        <div class="label-item">
                            <div class="label-age">60+</div>
                            <div>Critical</div>
                        </div>
                    </div>
                </div>

                <div class="improvement-message" id="improvementMessage">
                    <div class="message-title" id="messageTitle">Your Current Metabolic Age</div>
                    <div class="message-content" id="messageContent">Your metabolic age is 9 years older than your chronological age. Drag the slider left to see what improvements can help!</div>
                    <div class="metrics-list" id="metricsList">
                        <!-- Dynamic metrics will appear here -->
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3>Quick Actions</h3>
                <div class="action-buttons">
                    <a href="upload.html" class="action-btn">
                        <span class="action-btn-icon">📄</span>
                        Upload Report
                    </a>
                    <a href="history.html" class="action-btn">
                        <span class="action-btn-icon">📊</span>
                        View History
                    </a>
                    <a href="#" class="action-btn" onclick="scheduleCheckup()">
                        <span class="action-btn-icon">📅</span>
                        Schedule Checkup
                    </a>
                    <a href="profile.html" class="action-btn">
                        <span class="action-btn-icon">⚙️</span>
                        Update Profile
                    </a>
                </div>
            </div>
        </div>

        <!-- Metabolic Factors -->
        <div class="metabolic-factors">
            <h3 style="margin-bottom: 25px;">Key Metabolic Age Factors</h3>
            <div class="factors-grid" id="factorsGrid">
                <!-- Factors will be loaded dynamically -->
            </div>
        </div>

        <!-- Treatment Recommendations -->
        <div class="treatment-recommendations">
            <h3 style="margin-bottom: 25px;">🎯 Your Personalized Health Improvement Plan</h3>
            <div class="treatment-intro">
                <p>Based on your metabolic age assessment, we've curated specific programs to help you achieve optimal health. Our evidence-based approach combines nutrition, exercise, and lifestyle optimization.</p>
            </div>
            
            <div class="treatment-grid">
                <div class="treatment-card priority">
                    <div class="treatment-header">
                        <div class="treatment-icon">🏋️</div>
                        <div class="treatment-badge">Most Important</div>
                    </div>
                    <h4>Metabolic Reset Bootcamp</h4>
                    <p>Intensive 12-week program targeting insulin resistance and muscle building. Includes supervised workouts, meal planning, and weekly progress tracking.</p>
                    <div class="treatment-benefits">
                        <span class="benefit-tag">-8 years metabolic age</span>
                        <span class="benefit-tag">Muscle gain</span>
                        <span class="benefit-tag">Fat loss</span>
                    </div>
                    <div class="treatment-duration">Duration: 12 weeks</div>
                    <button class="treatment-btn primary" onclick="learnMore('bootcamp')">Learn More</button>
                </div>

                <div class="treatment-card">
                    <div class="treatment-header">
                        <div class="treatment-icon">🥗</div>
                    </div>
                    <h4>Personalized Nutrition Plan</h4>
                    <p>Custom meal plans based on your genetic profile and metabolic needs. Includes anti-inflammatory foods and portion optimization.</p>
                    <div class="treatment-benefits">
                        <span class="benefit-tag">-4 years metabolic age</span>
                        <span class="benefit-tag">Reduced inflammation</span>
                    </div>
                    <div class="treatment-duration">Duration: Ongoing</div>
                    <button class="treatment-btn" onclick="learnMore('nutrition')">Learn More</button>
                </div>

                <div class="treatment-card">
                    <div class="treatment-header">
                        <div class="treatment-icon">👨‍⚕️</div>
                    </div>
                    <h4>Medical Consultation</h4>
                    <p>One-on-one consultation with our metabolic health specialists to address specific health concerns and optimize treatment plans.</p>
                    <div class="treatment-benefits">
                        <span class="benefit-tag">Personalized care</span>
                        <span class="benefit-tag">Expert guidance</span>
                    </div>
                    <div class="treatment-duration">Duration: 60 minutes</div>
                    <button class="treatment-btn" onclick="learnMore('consultation')">Book Now</button>
                </div>

                <div class="treatment-card">
                    <div class="treatment-header">
                        <div class="treatment-icon">🧘</div>
                    </div>
                    <h4>Stress & Sleep Optimization</h4>
                    <p>Comprehensive program addressing cortisol management, sleep quality improvement, and stress reduction techniques.</p>
                    <div class="treatment-benefits">
                        <span class="benefit-tag">-3 years metabolic age</span>
                        <span class="benefit-tag">Better sleep</span>
                    </div>
                    <div class="treatment-duration">Duration: 8 weeks</div>
                    <button class="treatment-btn" onclick="learnMore('wellness')">Learn More</button>
                </div>

                <div class="treatment-card">
                    <div class="treatment-header">
                        <div class="treatment-icon">🔬</div>
                    </div>
                    <h4>Advanced Testing Package</h4>
                    <p>Comprehensive health screening including hormone panels, micronutrient analysis, and inflammatory markers for precise health optimization.</p>
                    <div class="treatment-benefits">
                        <span class="benefit-tag">Complete analysis</span>
                        <span class="benefit-tag">Precise targeting</span>
                    </div>
                    <div class="treatment-duration">One-time assessment</div>
                    <button class="treatment-btn" onclick="learnMore('testing')">Learn More</button>
                </div>

                <div class="treatment-card featured">
                    <div class="treatment-header">
                        <div class="treatment-icon">🏆</div>
                        <div class="treatment-badge featured">Complete Package</div>
                    </div>
                    <h4>Total Health Transformation</h4>
                    <p>Comprehensive 6-month program combining all our services: bootcamp, nutrition, consultations, and ongoing support for maximum results.</p>
                    <div class="treatment-benefits">
                        <span class="benefit-tag">-12 years metabolic age</span>
                        <span class="benefit-tag">Full support</span>
                        <span class="benefit-tag">Best value</span>
                    </div>
                    <div class="treatment-duration">Duration: 6 months</div>
                    <button class="treatment-btn featured" onclick="learnMore('complete')">Get Started</button>
                </div>
            </div>

            <div class="treatment-cta">
                <div class="cta-content">
                    <h4>Ready to Transform Your Health?</h4>
                    <p>Join thousands who have successfully reduced their metabolic age with NusaPulse programs. Our expert team is ready to guide your journey to optimal health.</p>
                    <button class="cta-btn" onclick="explorePrograms()">Explore All Programs</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Age status SVG icons
        const ageIcons = {
            excellent: '<path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="#22c55e"/>',
            good: '<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="#84cc16"/>',
            fair: '<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="#f59e0b"/>',
            poor: '<path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" fill="#ef4444"/>',
            critical: '<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="#dc2626"/>'
        };

        // Metabolic age improvement strategies
        const ageImprovements = {
            20: {
                title: "🌟 Optimal Metabolic Health",
                message: "Your metabolic age is exceptional! Focus on maintaining these excellent habits:",
                metrics: [
                    { title: "Maintain Muscle Mass", desc: "Continue strength training 3-4x per week", impact: "medium" },
                    { title: "Optimal Nutrition", desc: "Keep nutrient-dense, anti-inflammatory diet", impact: "medium" },
                    { title: "Stress Management", desc: "Continue meditation and recovery practices", impact: "medium" }
                ]
            },
            30: {
                title: "✅ Good Metabolic Health",
                message: "You're doing well! These optimizations will get you to optimal metabolic age:",
                metrics: [
                    { title: "Increase Protein Intake", desc: "Aim for 1.6-2.2g per kg body weight daily", impact: "high" },
                    { title: "Resistance Training", desc: "Add 2-3 strength training sessions per week", impact: "high" },
                    { title: "Improve Sleep Quality", desc: "Optimize for 7-9 hours of deep sleep", impact: "medium" }
                ]
            },
            40: {
                title: "📈 Fair Metabolic Health - Improvement Needed",
                message: "Your metabolic age needs attention. Focus on these key areas to reverse aging:",
                metrics: [
                    { title: "Fix Insulin Resistance", desc: "Reduce refined carbs, increase fiber to 35g+ daily", impact: "critical" },
                    { title: "Build Muscle Mass", desc: "Start progressive resistance training program", impact: "critical" },
                    { title: "Reduce Inflammation", desc: "Eliminate processed foods, add omega-3s", impact: "high" },
                    { title: "Intermittent Fasting", desc: "Try 16:8 fasting to improve metabolic flexibility", impact: "high" }
                ]
            },
            50: {
                title: "⚠️ Poor Metabolic Health - Action Required",
                message: "Multiple metabolic issues are aging you rapidly. These changes are critical:",
                metrics: [
                    { title: "Address Metabolic Syndrome", desc: "Work with doctor on blood sugar, BP, cholesterol", impact: "critical" },
                    { title: "Lose Visceral Fat", desc: "Combine caloric deficit with strength training", impact: "critical" },
                    { title: "Drastically Reduce Sugar", desc: "Eliminate all added sugars and refined carbs", impact: "critical" },
                    { title: "Increase Daily Activity", desc: "Walk 10,000+ steps, add movement every hour", impact: "high" }
                ]
            },
            60: {
                title: "🚨 Critical Metabolic Health",
                message: "Your metabolic age indicates severe health risks. Immediate intervention needed:",
                metrics: [
                    { title: "Medical Intervention", desc: "Immediate doctor consultation for metabolic panel", impact: "critical" },
                    { title: "Comprehensive Diet Overhaul", desc: "Work with nutritionist on metabolic reset plan", impact: "critical" },
                    { title: "Supervised Exercise Program", desc: "Start with medical clearance and supervision", impact: "critical" },
                    { title: "Sleep Disorder Treatment", desc: "Address sleep apnea and poor sleep quality", impact: "critical" }
                ]
            }
        };

        // Sample user data
        const userData = {
            user: { firstName: "John", lastName: "Doe" },
            chronologicalAge: 33,
            metabolicAge: 42,
            factors: [
                { name: "Muscle Mass", value: "Below Average", impact: "Ages you +5 years", status: "poor" },
                { name: "Visceral Fat", value: "18%", impact: "Ages you +3 years", status: "fair" },
                { name: "Insulin Sensitivity", value: "Resistant", impact: "Ages you +7 years", status: "poor" },
                { name: "VO2 Max", value: "32 ml/kg/min", impact: "Ages you +2 years", status: "fair" },
                { name: "Inflammation (CRP)", value: "4.2 mg/L", impact: "Ages you +4 years", status: "poor" },
                { name: "Sleep Quality", value: "5.5 hrs avg", impact: "Ages you +3 years", status: "fair" },
                { name: "Stress (Cortisol)", value: "Elevated", impact: "Ages you +2 years", status: "fair" },
                { name: "RMR (Metabolism)", value: "1,680 cal/day", impact: "Ages you +1 year", status: "good" }
            ]
        };

        // Global variables
        let currentMetabolicAge = 42;
        let chronologicalAge = 33;
        let isDragging = false;
        let sliderMinX = 0;
        let sliderMaxX = 0;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            const token = localStorage.getItem('NusaPulse_token');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }

            loadUserData();
            loadMetabolicFactors();
            initializeAgeSlider();
        });

        function loadUserData() {
            const user = JSON.parse(localStorage.getItem('NusaPulse_user')) || userData.user;
            const fullName = `${user.firstName} ${user.lastName}`;
            
            document.getElementById('userName').textContent = fullName;
            document.getElementById('mobileUserName').textContent = fullName;
            document.getElementById('welcomeName').textContent = user.firstName;
            
            // Set age values
            document.getElementById('chronologicalAge').textContent = chronologicalAge;
            document.getElementById('metabolicAge').textContent = currentMetabolicAge;
            
            // Calculate and display age difference
            updateAgeDifference();
        }

        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuIcon = document.getElementById('menuIcon');
            
            mobileMenu.classList.toggle('active');
            
            // Change hamburger to X when open
            if (mobileMenu.classList.contains('active')) {
                menuIcon.textContent = '✕';
            } else {
                menuIcon.textContent = '☰';
            }
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuBtn = document.querySelector('.mobile-menu-btn');
            const navbar = document.querySelector('.navbar');
            
            if (!navbar.contains(event.target) && mobileMenu.classList.contains('active')) {
                mobileMenu.classList.remove('active');
                document.getElementById('menuIcon').textContent = '☰';
            }
        });

        function updateAgeDifference() {
            const difference = currentMetabolicAge - chronologicalAge;
            const diffElement = document.getElementById('ageDifference');
            const metabolicAgeElement = document.getElementById('metabolicAge');

            const absDiff = Math.abs(difference).toFixed(1);
            const unit = (absDiff == 1.0 ? "year" : "years");

            if (difference > 0) {
                diffElement.textContent = `${absDiff} ${unit} older`;
                diffElement.className = 'age-difference';
                metabolicAgeElement.className = 'age-value metabolic-age';
            } else if (difference < 0) {
                diffElement.textContent = `${absDiff} ${unit} younger`;
                diffElement.className = 'age-difference better';
                metabolicAgeElement.className = 'age-value age-better';
            } else {
                diffElement.textContent = 'Same age';
                diffElement.className = 'age-difference better';
                metabolicAgeElement.className = 'age-value age-better';
            }
        }

        function loadMetabolicFactors() {
            const container = document.getElementById('factorsGrid');
            container.innerHTML = '';

            userData.factors.forEach(factor => {
                const factorElement = document.createElement('div');
                factorElement.className = `factor-item ${factor.status}`;
                
                factorElement.innerHTML = `
                    <div class="factor-name">${factor.name}</div>
                    <div class="factor-value">${factor.value}</div>
                    <div class="factor-impact">${factor.impact}</div>
                    <div class="factor-status">${factor.status}</div>
                `;
                container.appendChild(factorElement);
            });
        }

        function initializeAgeSlider() {
            const slider = document.getElementById('ageSlider');
            const track = slider.parentElement;
            
            // Calculate boundaries (age range 20-65)
            const trackRect = track.getBoundingClientRect();
            sliderMinX = 35; // Padding from left
            sliderMaxX = trackRect.width - 35; // Padding from right
            
            // Set initial position
            updateSliderPosition(currentMetabolicAge);
            updateSliderAppearance(currentMetabolicAge);
            updateImprovementMessage(currentMetabolicAge);

            // Add event listeners
            slider.addEventListener('mousedown', startDragging);
            slider.addEventListener('touchstart', startDragging);
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('mouseup', stopDragging);
            document.addEventListener('touchend', stopDragging);

            // Prevent default drag behavior
            slider.addEventListener('dragstart', e => e.preventDefault());
        }

        function startDragging(e) {
            isDragging = true;
            e.preventDefault();
        }

        function drag(e) {
            if (!isDragging) return;

            const track = document.getElementById('ageSlider').parentElement;
            const trackRect = track.getBoundingClientRect();
            
            const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            let x = clientX - trackRect.left;
            
            // Keep within bounds
            x = Math.max(sliderMinX, Math.min(x, sliderMaxX));
            
            // Convert position to age (20-65 range)
            const age = 20 + ((x - sliderMinX) / (sliderMaxX - sliderMinX)) * 45;
            
            // Allow full range movement
            updateSliderPosition(age);
            updateSliderAppearance(age);
            updateImprovementMessage(age);
            updateDisplayedAge(age);
        }

        function stopDragging() {
            isDragging = false;
        }

        function updateSliderPosition(age) {
            const slider = document.getElementById('ageSlider');
            // Map age 20-65 to position
            const agePercent = (age - 20) / 45;
            const position = sliderMinX + (agePercent * (sliderMaxX - sliderMinX));
            
            slider.style.left = position + 'px';
            document.getElementById('sliderAge').textContent = Math.round(age);
        }

        function updateSliderAppearance(age) {
            const slider = document.getElementById('ageSlider');
            const icon = document.getElementById('ageIcon');
            
            let category, iconSvg, borderColor;
            
            if (age <= 25) {
                category = 'excellent';
                iconSvg = ageIcons.excellent;
                borderColor = '#22c55e';
            } else if (age <= 35) {
                category = 'good';
                iconSvg = ageIcons.good;
                borderColor = '#84cc16';
            } else if (age <= 45) {
                category = 'fair';
                iconSvg = ageIcons.fair;
                borderColor = '#f59e0b';
            } else if (age <= 55) {
                category = 'poor';
                iconSvg = ageIcons.poor;
                borderColor = '#ef4444';
            } else {
                category = 'critical';
                iconSvg = ageIcons.critical;
                borderColor = '#dc2626';
            }

            icon.innerHTML = iconSvg;
            slider.style.borderColor = borderColor;
        }

        function updateDisplayedAge(age) {
            document.getElementById('metabolicAge').textContent = Math.round(age);
            currentMetabolicAge = age;
            updateAgeDifference();
        }

        function updateImprovementMessage(targetAge) {
            const messageTitle = document.getElementById('messageTitle');
            const messageContent = document.getElementById('messageContent');
            const metricsList = document.getElementById('metricsList');

            // Find the appropriate improvement range
            let improvementKey = 60;
            if (targetAge <= 25) improvementKey = 20;
            else if (targetAge <= 35) improvementKey = 30;
            else if (targetAge <= 45) improvementKey = 40;
            else if (targetAge <= 55) improvementKey = 50;

            const improvement = ageImprovements[improvementKey];

            if (Math.abs(targetAge - 42) < 1) {
                // At current metabolic age
                messageTitle.textContent = "Your Current Metabolic Age";
                messageContent.textContent = `Your metabolic age is ${Math.round(targetAge - chronologicalAge)} years older than your chronological age. Drag the slider left to see what improvements can help reverse this!`;
                metricsList.innerHTML = '';
            } else {
                // Showing improvement path
                const ageReduction = Math.round(42 - targetAge);
                messageTitle.textContent = `To reach age ${Math.round(targetAge)}: ${improvement.title}`;
                messageContent.textContent = improvement.message;
                
                // Show specific metabolic improvements
                metricsList.innerHTML = improvement.metrics.map(metric => {
                    const sign = ageReduction >= 0 ? "-" : "+";
                    return `
                        <div class="metric-item ${metric.impact}">
                            <svg class="metric-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="${metric.icon}"/>
                            </svg>
                            <div class="metric-text">
                                <div class="metric-title">${metric.title}</div>
                                <div class="metric-desc">${metric.desc}</div>
                            </div>
                            <span class="metric-impact ${metric.impact}">${sign}${Math.abs(ageReduction)} years</span>
                        </div>
                    `;
                }).join('');
            }
        }

        function scheduleCheckup() {
            alert('Metabolic age assessment scheduling will be available soon! Please contact our support team.');
        }

        function learnMore(program) {
            const programInfo = {
                bootcamp: {
                    name: 'Metabolic Reset Bootcamp',
                    description: 'Our flagship 12-week intensive program designed specifically for individuals with insulin resistance and metabolic dysfunction.',
                    includes: 'Supervised workouts, meal planning, weekly body composition tracking, hormone optimization, and lifestyle coaching.'
                },
                nutrition: {
                    name: 'Personalized Nutrition Plan',
                    description: 'Custom nutrition program based on your genetic profile, food sensitivities, and metabolic needs.',
                    includes: 'DNA-based meal plans, anti-inflammatory protocols, supplement recommendations, and ongoing nutritionist support.'
                },
                consultation: {
                    name: 'Medical Consultation',
                    description: 'Comprehensive health assessment with our metabolic medicine specialists.',
                    includes: 'Full health review, personalized treatment plan, medication optimization, and follow-up protocols.'
                },
                wellness: {
                    name: 'Stress & Sleep Optimization',
                    description: 'Holistic approach to stress management and sleep quality improvement.',
                    includes: 'Cortisol regulation protocols, sleep hygiene optimization, mindfulness training, and relaxation techniques.'
                },
                testing: {
                    name: 'Advanced Testing Package',
                    description: 'Comprehensive laboratory analysis to identify root causes of metabolic dysfunction.',
                    includes: 'Hormone panels, micronutrient analysis, inflammatory markers, toxin screening, and genetic testing.'
                },
                complete: {
                    name: 'Total Health Transformation',
                    description: 'Complete 6-month health optimization program combining all our services.',
                    includes: 'All programs combined with dedicated health coach, priority support, and guaranteed results.'
                }
            };

            const info = programInfo[program];
            const message = `${info.name}\n\n${info.description}\n\nIncludes: ${info.includes}\n\nWould you like to learn more about this program?`;
            
            if (confirm(message)) {
                // Redirect to NusaPulse website with program parameter
                window.open(`https://nusapulse.my/programs/${program}`, '_blank');
            }
        }

        function explorePrograms() {
            // Show loading state
            const button = event.target;
            const originalText = button.textContent;
            
            button.textContent = 'Loading...';
            button.disabled = true;

            setTimeout(() => {
                // Redirect to NusaPulse main programs page
                window.open('https://nusapulse.my/health-programs', '_blank');
                
                button.textContent = originalText;
                button.disabled = false;
            }, 1000);
        }

        function logout() {
            localStorage.removeItem('NusaPulse_token');
            localStorage.removeItem('NusaPulse_user');
            window.location.href = 'login.html';
        }

        // Handle window resize
        window.addEventListener('resize', function() {
            const track = document.getElementById('ageSlider').parentElement;
            const trackRect = track.getBoundingClientRect();
            sliderMinX = 35;
            sliderMaxX = trackRect.width - 35;
            updateSliderPosition(currentMetabolicAge);
        });
    </script>
</body>
</html>